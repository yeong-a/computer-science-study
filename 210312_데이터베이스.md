## 데이터 베이스 언어

### 데이터 정의어(DDL)

데이터베이스 개채를 생성, 변경, 삭제하기 위한 명령어.Create, Alter, Drop

### 데이터 조작어(DML)

데이터를 검색, 추가, 삭제, 업데이트하기 위한 명령어.Select, Insert, Delete, Update

### 데이터 제어어(DCL)

보안 및 권한 제어, 무결성, 회복, 병행 제어를 위한 명령어.Grant, Revoke, Commit, Rollback 등

## 트랜잭션 및 ACID

트랜잭션이란, 데이터베이스의 상태를 변화시키기 위해서 수행하는 작업의 단위입니다.

트랜잭션을 사용하는 이유는,  트랜잭션의 모든 명령문이 완벽하게 처리되거나 하나도 처리되지 않아야 데이터 베이스가 모순이 없는 상태를 유지할 수 있기 때문입니다.

트랙잭션의 연산에는 commit과 rollback이 있습니다.

### Commit

트랜잭션 연산이 성공적으로 수행된 후, 데이터베이스에 반영하는 연산입니다.

### Rollback

트랜잭션 연산이 실패하면, 트랜잭션을 실행하기 전으로 되돌리는 연산입니다. 

### SAVEPOINT

SAVEPOINT는 Rollback연산을 할 때 전체가 아닌 특정 부분까지 트랜잭션을 취소할 수 있는 연산입니다.

### ACID

ACID는 트랜잭션이 가지고 있는 4가지의 특성입니다.

- 원자성(Atomicity) : 트랜잭션이 DB에 모두 반영되거나, 혹은 전혀 반영되지 않아야 한다.
- 일관성(Consistency) : 트랜잭션의 작업 처리 결과는 항상 일관성이 있어야 한다.
- 독립성(Isolation) : 둘 이상의 트랜잭션이 동시에 병행 실행되고 있을 때, 어떤 트랜잭션도 다른 트랜잭션 연산에 끼어들 수 없다.
- 영속성(Durability) : 트랜잭션이 성공적으로 완료 되었으면 결과는 영구적으로 반영되어야 한다.

## 데이터 베이스 장애

1. 트랜잭션 장애 : 트랜잭션 수행 중 오류가 발생하여 정상적으로 수행을 계속할 수 없는 상태입니다. 원인은 트랜잭션의 논리적 오류, 잘못된 데이터 입력, 처리 대상 데이터의 부재 등...
2. 시스템 장애 : 하드웨어의 결함으로 정상적으로 수행을 계속할 수 없는 상태입니다. 예시로, 메인 메모리에 저장된 정보가 손실되거나 교착상태가 발생하는 경우 등이 있습니다.
3. 미디어 장애 : 디스크 장치의 결함으로 디스크에 저장된 데이터베이스가 손상된 상태를 말합니다.

### Undo와 Redo

- Undo: 트랜잭션 로그를 이용하여 오류와 관련된 모든 변경을 '취소'하여 복구를 수행합니다.
- Redo: 트랜잭션 로그를 이용하여 오류가 발생한 트랜잭션을 '재실행'하여 복구를 수행합니다.

### 데이터 베이스 장애 발생 시 회복 기법

#### 로그를 이용한 회복

1. 지연갱신 회복 기법 :  Redo 수행

    트랜잭션이 성공적으로 종료될 때까지 데이터베이스의 갱신을 지연하는 방법입니다. 만약 트랜잭션 장애가 발생하면, 로그에 있는 변경기록을 지우면 되기 때문에 Redo만 수행합니다.

2. 즉시갱신 회복 기법 : Redo, Undo 수행

    트랜잭션 연산으로 인해 변경점이 생기면 데이터베이스에 변경점이 생기면 즉시 갱신하는 방법입니다. 때문에 트랜잭션 장애가 발생하면 Redo와 Undo 모두 수행합니다.

#### 검사점 회복 기법

장애 발생 시 검사점(CheckPoint) 이전에 처리된 트랜잭션은 회복에서 제외하고, 검사점 이후에 처리된 트랜잭션은 회복 작업을 수행하는 기법입니다.

회복을 수행하는 트랜잭션은 두가지로 구분할 수 있는데, 장애 발생 이전에 트랜잭션이 commit된 경우는 Redo를 수행하고, commit 되지 않은 경우는 Undo를 수행합니다.

#### 미디어 회복 기법

디스크와 같은 저장 장치가 손상되는 장애를 대처하기 위한 회복 기법입니다. 데이터 베이스의 내용을 백업하거나 미러링해서 별도의 저장장치에 dump합니다.

미디어 장애가 발생하면 가장 최근 dump를 복구하고 dump 이후의 작업을 Redo합니다.

## 데이터 베이스 무결성

데이터 베이스의 무결성이란, 말 그대로 데이터 베이스에 결함이 없는 상태입니다. 즉, 데이터를 정확하고 유효하게 유지해야 합니다. 데이터 베이스의 무결성을 보장하기 위해서는 무결성 제약조건이 필요합니다. 

### 무결성 제약조건의 종류

1. 개체 무결성: 기본키는 null값이 될 수 없습니다. 기본키나 기본키를 구성하는 속성이 null값이 되면 튜플의 유일성을 판단할 수 없기 때문입니다.
2. 참조 무결성: 외래키는 참조할 수 없는 값을 가질 수 없습니다. 즉, 외래키는 참조하는 릴레이션의 기본값과 같거나 NULL값이어야 합니다.
3. 도메인 무결성: 애트리뷰트의 값이 정의된 도메인에 속하는 값이어야 합니다. 
4. 키 무결성: 릴레이션에는 최소한 하나의 키가 존재해야 합니다.
5. null 무결성: 릴레이션의 특정 속성 값이 NULL이 될 수 없도록 정의 되어 있다면, 그 속성의 값은 NULL이 될 수 없습니다.
6. 고유 무결성: 릴레이션의 특정 속성에 대해 각 튜플이 갖는 속성값을이 서로 달라야 합니다. 예를 들어, 학생 테이블의 주민등록번호 속성의 값은 각 튜플마다 다른 값을 가져야 합니다.

## 정규화

데이터 베이스 정규화란, 데이터 구조의 안정성, 무결성을 유지하기 위해 릴레이션을 분리하는 과정입니다. 정규화를 거치면 데이터의 중복을 배제해 데이터 베이스 이상 현상을 방지할 수 있습니다. 또한, 정규화 과정에서 데이터의 무손실을 원칙으로 합니다.

### 이상 현상(Anomaly)

1. 삽입 이상

    데이터를 삽입할 때, 원하지 않는 값도 함께 삽입되는 이상 현상입니다.

2. 삭제 이상

    데이터를 삭제할 때, 원하지 않는 값도 함께 삭제되는 이상 현상입니다.

3. 갱신 이상

    데이터를 갱신 할 때, 일부 튜플의 값만 갱신되어 데이터 베이스에 모순이 생기는 이상 현상입니다.

### 정규화 과정

- 제 1 정규화 : 릴레이션에 속한 모든 도메인이 원자값으로 이루어진 상태입니다. 예를 들어, 학생 테이블의 이름 속성의 값은 한 개의 이름만 가질 수 있습니다.
- 제 2 정규화 : 기본키가 아닌 모든 속성이 기본키에 대해 부분 함수적 종속을 제거하고, 완전 함수적 종속으로만 이루어진 상태입니다. 예를 들어, 학생 테이블의 기본키가 학번과 과목으로 이루어져 있을 때, 이름 속성은 학번으로만 결정됩니다. 이것을 부분 함수적 종속이라고 합니다. 따라서 제 2 정규화를 만족시키려면 릴레이션을 [학번(기본키)+이름(속성)]으로 나누어야 합니다.
- 제 3 정규화 :  기본키가 아닌 모든 속성이 기본키에 대해 이행적 함수 종속을 만족시키지 않는 상태입니다. 이행적 종속이란, A→ B 이고 B → C  일 때, A → C를 만족하는 관계입니다.
- BCNF(Boyce-Codd 정규화): 결정자가 모두 후보키인 상태입니다.
- 제 4 정규화: 다치 종속 제거
- 제 5 정규화 : 조인 종속 제거

## 반정규화

반정규화란, 데이터의 검색 속도 향상 등을 이유로 의도적으로 정규화를 위배하는 행위를 말합니다. 정규화를 함으로써 데이터의 독립을 보장하여 데이터 베이스의 무결성을 보장할 수 있지만, 릴레이션 간의 참조를 많이 하게 되면 속도의 저하가 일어날 수 있기 때문입니다.

### 반정규화의 종류

1. 테이블 분할
    - 수평 분할 : 레코드 단위로 분할
    - 수직 분할 : 속성 단위로 분할
2. 테이블 통합: 자주 조인이 발생하는 테이블을 통합하는 방법입니다.
3. 중복 속성 추가: 자주 참조하는 속성을 추가하는 방법입니다.
4. 중복 테이블 추가: 집계 테이블, 진행 테이블, 특정 부분만을 포함하는 테이블 등을 추가하는 방법입니다.

## RDBMS와 NoSql

데이터 베이스는 크게 관계형(RDBMS)과 비 관계형(Nosql)으로 나눌 수 있습니다. RDBMS는 관계형 데이터 베이스를 관리할 수 있는 소프트웨어이고, Nosql은 데이터간의 관계를 정의하지 않고 자유롭게 데이터 베이스를 관리할 수 있습니다.

### RDBMS의 특징

- 데이터 베이스를 관리하는 SQL를 사용합니다.
- RDBMS는 모든 데이터를 2차원 테이블의 형태로 관리합니다. 따라서 데이터의 분류, 정렬, 탐색 속도가 빠릅니다.
- 반드시 정의된 스키마의 형태를 따라야 합니다. 따라서 데이터를 유연하게 저장할 수 없지만, 명확한 데이터 구조를 보장합니다.
- 데이터의 수직적 확장을 합니다. 수직적 확장이란, 하드웨어를 업그레이드하거나 추가하여 서버의 성능을 향상 시키는 것입니다. 수직적 확장은 한계가 존재합니다.

### Nosql의 특징

- 데이터의 구조를 정의하는 스키마가 없기 때문에 자유로운 데이터 저장이 가능하지만, 원하는 데이터를 찾기 어렵습니다.
- 데이터의 규격이 정의되어 있지 않기 때문에 RDBMS보다 훨씬 많은 데이터를 저장할 수 있습니다.
- Nosql은 데이터의 수평적 확장이 가능합니다. 수평적 확장이란 서버를 증설하여 저장할 수 있는 데이터의 양을 늘리는 것입니다.
